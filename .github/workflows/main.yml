name: Frontend CI Workflow

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    build-and-test:
        runs-on: ubuntu-latest

        steps:
            - name: ì½”ë“œ í´ë¡ 
              uses: actions/checkout@v2

            - name: Node.js ì„¤ì¹˜
              uses: actions/setup-node@v2
              with:
                  node-version: "16"

            - name: ì˜ì¡´ì„± ì„¤ì¹˜
              run: npm install
              working-directory: ./jiyun_portfolio
              
            - name: ì½”ë“œ ìŠ¤íƒ€ì¼ ê²€ì‚¬ (ESLint)
              run: npm run lint
              working-directory: ./jiyun_portfolio  # ê²½ë¡œ ì¶”ê°€

            - name: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (Jest)
              run: npm run test
              working-directory: ./jiyun_portfolio  # ê²½ë¡œ ì¶”ê°€

            - name: í”„ë¡œì íŠ¸ ë¹Œë“œ (Next.js)
              run: npm run build
              working-directory: ./jiyun_portfolio  # ê²½ë¡œ ì¶”ê°€

            - name: ë°°í¬ëœ ì‚¬ì´íŠ¸ ìƒíƒœ í™•ì¸
              run: |
                  response=$(curl -o /dev/null -s -w "%{http_code}" https://kimjiyun.site)
                  if [ $response -ne 200 ]; then
                    echo "ğŸš¨ ì‚¬ì´íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. HTTP ìƒíƒœ ì½”ë“œ: $response"
                    exit 1
                  else
                    echo "âœ… ì‚¬ì´íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!"
                  fi
